<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="css/bootstrap-sketchy.min.css">
    <!--    mapBox CSS-->
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.1/mapbox-gl.css' rel='stylesheet' />
    <!--Mapbox search plugin css for search bar-->
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.4.1/mapbox-gl-geocoder.css' type='text/css' />
<!--    My custom styles-->
    <style>
        .jumbotron1{
            background: linear-gradient(to bottom, #87e0fd 0%,#53cbf1 40%,#05abe0 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */

        }

        .currentTemp{
            display: inline;
        }

        .weatherIcon{
            height: 150px;
        }

        .currentTemp{
            font-size: 4em;

        }
        .mapBoxCard{
            width: 50%;
            height: 400px;
        }
        .currentWeatherCard{
            width: 50%;
        }

        #map{
            padding: 0px;
        }

        .dailyForecast{
            width: 100%;
        }
    </style>
</head>
<body>
<!--NavBar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand" href="#">Navbar</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarColor02">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
                <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Features</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Pricing</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">About</a>
            </li>
        </ul>
        <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="text" placeholder="Search">
            <button class="btn btn-secondary my-2 my-sm-0" type="submit">Search</button>
        </form>
    </div>
</nav>

<!--First look data container-->
<div class="jumbotron jumbotron1 d-flex flex-wrap justify-content-center ">

</div>

<!--mapbox search bar-->
<div class="search-container d-flex flex-wrap justify-content-center">
    <!-- Search bar card-->
    <div class="card bg-light mb-3" style="max-width: 20rem;">
        <div class="card-header">Search bar</div>
        <div class="card-body">
            <h4 class="card-title">Search Bar</h4>

        </div>
    </div>
</div>



<!--Container for Map and current weather-->
<div class="mapDataContainer d-flex flex-wrap justify-content-center">
    <!--Mapbox Card -->
    <div class="mapBoxCard card bg-light mb-3" style="max-width: 400px;">
        <div class="col" id='map' style='width: 100vw; height: 100vh;'></div>
    </div>

    <!-- Current weather data box-->
    <div class="currentWeatherCard card bg-light mb-3" >
        <div class="card-header">Weather Data Card</div>
        <div class="card-body">
            <h4 class="card-title">Light card title</h4>
            <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
        </div>
    </div>
</div>

<!-- 3 day weather data box-->
<div class="dailyForecast card bg-light mb-3" >

</div>


<!--Mapbox search plugin javascript for search bar-->
<script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.4.1/mapbox-gl-geocoder.min.js'></script>
<!--MapBox api-->
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.1/mapbox-gl.js'></script>
<!--jquery-->
<script src="js/jquery-2.2.4.js"></script>
<!--keys-->
<script src="js/keys.js"></script>
<!--Custom JS-->
<script>
   $(document).ready(function () {

       function mapBoxApi() {
           // MapBox
           mapboxgl.accessToken = mapBoxToken;
           var map = new mapboxgl.Map({
               container: 'map',
               style: 'mapbox://styles/mapbox/streets-v9',
               zoom: 12,
               // center: [-122.420679, 37.772537] // San Francisco
               center: [-98.4916, 29.4252] // San Antonio
               // center: [-77.0369, 38.9072] // Washington D.C
               // center: [-97.7718784, 31.0810943] // Killeen, TX


           });

           var customData = {
               "features": [
                   {
                       "type": "Feature",
                       "properties": {
                           "title": "Pinch Boil House",
                           "address": "214 Broadway St, San Antonio, Tx 78205",
                           "phone": "210-257-5152",
                           "description": "Blah Blah Blah"
                       },
                       "geometry": {
                           "coordinates": [
                               -98.4958736,
                               29.4259826

                           ],
                           "type": "Point"
                       }
                   }

               ],
               "type": "FeatureCollection"
           };

           // Search function
           map.addControl(new MapboxGeocoder({
               accessToken: mapboxgl.accessToken,
               localGeocoder: forwardGeocoder,
               zoom: 14,
               placeholder: "Enter search e.g. Lincoln Park",
               mapboxgl: mapboxgl
           }));

           function forwardGeocoder(query) {
               var matchingFeatures = [];
               for (var i = 0; i < customData.features.length; i++) {
                   var feature = customData.features[i];
                   // handle queries with different capitalization than the source data by calling toLowerCase()
                   if (feature.properties.title.toLowerCase().search(query.toLowerCase()) !== -1) {
                       // add a tree emoji as a prefix for custom data results
                       // using carmen geojson format: https://github.com/mapbox/carmen/blob/master/carmen-geojson.md
                       feature['place_name'] = 'ðŸ» ' + feature.properties.title;
                       feature['center'] = feature.geometry.coordinates;
                       feature['place_type'] = ['park'];
                       matchingFeatures.push(feature);
                   }
               }
               return matchingFeatures;
           }

       }

       function firstLookWeather() {
           var firstLookData = "";
           $.ajax("https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/" + darkSkyKey + "/29.4241,-98.4936").done(function (data) {
                              // Data in Jumbotron at top of page
                var firstLookData = '';
                firstLookData += '<div>';
               firstLookData += '<div class="jumbotron1-box1 d-flex flex-wrap justify-content-center align-items-center">';
                firstLookData += '<h1 class="locationName display-3 text-center">' + 'San Antonio Weather' + '</h1>';
                firstLookData += '<img class="weatherIcon" src="icon/SVG/Sun.svg" alt="">';
                firstLookData += '<div class="currentTemp">' + data.currently.temperature + '&#176;' + '</div>';
               firstLookData += '</div>'; // end jumbotron1-box1
                firstLookData += '</div>';
                $('.jumbotron1').html(firstLookData);



               // data.currently.forEach(function (data) {
               //     console.log(data);
               //
               //     firstLookData += '<div>';
               //     firstLookData += '<h1 class="locationName display-3 text-center">' + 'San Antonio Weather' + '</h1>';
               //     firstLookData += '<img src="icon/SVG/Sun.svg" alt="">';
               //     firstLookData += '<div class="weatherIcon">' + temperature + '</div>';
               //     firstLookData += '</div>';
               //     $('.jumbotron1').html(firstLookData)
               //
               // }); //end of forEach()

           }); // end of .get()

       } // end of first Look Weather function

       function threeDayForcast() {
           var threeDayForcastData = "";
           $.ajax("https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/" + darkSkyKey + "/29.4241,-98.4936").done(function (data) {
               console.log(data.daily.data);
               // console.log(data.currently);
               // Current weather temp
            for(var i = 0; i < 3; i++){
                console.log(data.daily.data[i]);

                var icons =[
                    // clear-day, clear-night, rain, snow, sleet, wind, fog, cloudy, partly-cloudy-day, partly-cloudy-night
                    {
                        weather:"clear-day",
                        url:'icon/SVG/'
                    }

                    ];

                // Daily forecast data
                threeDayForcastData += '<div>';
                threeDayForcastData += '<div class="jumbotron1-box1 d-flex flex-wrap justify-content-center align-items-center">';
                threeDayForcastData += '<h1 class="locationName display-3 text-center">' + 'San Antonio Weather' + '</h1>';
                threeDayForcastData += '<img class="weatherIcon" src="icon/SVG/Sun.svg" alt="">';
                threeDayForcastData += '<div class="currentTemp">' + data.currently.temperature + '&#176;' + '</div>';
                threeDayForcastData += '</div>'; // end jumbotron1-box1
                threeDayForcastData += '</div>';
                $('.dailyForecast').html(threeDayForcastData);

            }

           }); // end of .get()

       } // end of first Look Weather function

       firstLookWeather(); // Calling the firstLookWeather function
       threeDayForcast(); // Calling threeDayForcast function
       mapBoxApi() // Calling the mapBoxApi function
   }) // End of document ready
</script>
</body>
</html>